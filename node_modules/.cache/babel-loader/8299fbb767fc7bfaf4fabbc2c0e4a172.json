{"ast":null,"code":"/*!\n * Flash export buttons for Buttons and DataTables.\n * 2015-2017 SpryMedia Ltd - datatables.net/license\n *\n * ZeroClipbaord - MIT license\n * Copyright (c) 2012 Joseph Huckaby\n */\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['jquery', 'datatables.net', 'datatables.net-buttons'], function ($) {\n      return factory($, window, document);\n    });\n  } else if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = function (root, $) {\n      if (!root) {\n        root = window;\n      }\n\n      if (!$ || !$.fn.dataTable) {\n        $ = require('datatables.net')(root, $).$;\n      }\n\n      if (!$.fn.dataTable.Buttons) {\n        require('datatables.net-buttons')(root, $);\n      }\n\n      return factory($, root, root.document);\n    };\n  } else {\n    // Browser\n    factory(jQuery, window, document);\n  }\n})(function ($, window, document, undefined) {\n  'use strict';\n\n  var DataTable = $.fn.dataTable;\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * ZeroClipboard dependency\n   */\n\n  /*\n   * ZeroClipboard 1.0.4 with modifications\n   * Author: Joseph Huckaby\n   * License: MIT\n   *\n   * Copyright (c) 2012 Joseph Huckaby\n   */\n\n  var ZeroClipboard_TableTools = {\n    version: \"1.0.4-TableTools2\",\n    clients: {},\n    // registered upload clients on page, indexed by id\n    moviePath: '',\n    // URL to movie\n    nextId: 1,\n    // ID of next movie\n    $: function (thingy) {\n      // simple DOM lookup utility function\n      if (typeof thingy == 'string') {\n        thingy = document.getElementById(thingy);\n      }\n\n      if (!thingy.addClass) {\n        // extend element with a few useful methods\n        thingy.hide = function () {\n          this.style.display = 'none';\n        };\n\n        thingy.show = function () {\n          this.style.display = '';\n        };\n\n        thingy.addClass = function (name) {\n          this.removeClass(name);\n          this.className += ' ' + name;\n        };\n\n        thingy.removeClass = function (name) {\n          this.className = this.className.replace(new RegExp(\"\\\\s*\" + name + \"\\\\s*\"), \" \").replace(/^\\s+/, '').replace(/\\s+$/, '');\n        };\n\n        thingy.hasClass = function (name) {\n          return !!this.className.match(new RegExp(\"\\\\s*\" + name + \"\\\\s*\"));\n        };\n      }\n\n      return thingy;\n    },\n    setMoviePath: function (path) {\n      // set path to ZeroClipboard.swf\n      this.moviePath = path;\n    },\n    dispatch: function (id, eventName, args) {\n      // receive event from flash movie, send to client\n      var client = this.clients[id];\n\n      if (client) {\n        client.receiveEvent(eventName, args);\n      }\n    },\n    log: function (str) {\n      console.log('Flash: ' + str);\n    },\n    register: function (id, client) {\n      // register new client to receive events\n      this.clients[id] = client;\n    },\n    getDOMObjectPosition: function (obj) {\n      // get absolute coordinates for dom element\n      var info = {\n        left: 0,\n        top: 0,\n        width: obj.width ? obj.width : obj.offsetWidth,\n        height: obj.height ? obj.height : obj.offsetHeight\n      };\n\n      if (obj.style.width !== \"\") {\n        info.width = obj.style.width.replace(\"px\", \"\");\n      }\n\n      if (obj.style.height !== \"\") {\n        info.height = obj.style.height.replace(\"px\", \"\");\n      }\n\n      while (obj) {\n        info.left += obj.offsetLeft;\n        info.top += obj.offsetTop;\n        obj = obj.offsetParent;\n      }\n\n      return info;\n    },\n    Client: function (elem) {\n      // constructor for new simple upload client\n      this.handlers = {}; // unique ID\n\n      this.id = ZeroClipboard_TableTools.nextId++;\n      this.movieId = 'ZeroClipboard_TableToolsMovie_' + this.id; // register client with singleton to receive flash events\n\n      ZeroClipboard_TableTools.register(this.id, this); // create movie\n\n      if (elem) {\n        this.glue(elem);\n      }\n    }\n  };\n  ZeroClipboard_TableTools.Client.prototype = {\n    id: 0,\n    // unique ID for us\n    ready: false,\n    // whether movie is ready to receive events or not\n    movie: null,\n    // reference to movie object\n    clipText: '',\n    // text to copy to clipboard\n    fileName: '',\n    // default file save name\n    action: 'copy',\n    // action to perform\n    handCursorEnabled: true,\n    // whether to show hand cursor, or default pointer cursor\n    cssEffects: true,\n    // enable CSS mouse effects on dom container\n    handlers: null,\n    // user event handlers\n    sized: false,\n    sheetName: '',\n    // default sheet name for excel export\n    glue: function (elem, title) {\n      // glue to DOM element\n      // elem can be ID or actual DOM element object\n      this.domElement = ZeroClipboard_TableTools.$(elem); // float just above object, or zIndex 99 if dom element isn't set\n\n      var zIndex = 99;\n\n      if (this.domElement.style.zIndex) {\n        zIndex = parseInt(this.domElement.style.zIndex, 10) + 1;\n      } // find X/Y position of domElement\n\n\n      var box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement); // create floating DIV above element\n\n      this.div = document.createElement('div');\n      var style = this.div.style;\n      style.position = 'absolute';\n      style.left = '0px';\n      style.top = '0px';\n      style.width = box.width + 'px';\n      style.height = box.height + 'px';\n      style.zIndex = zIndex;\n\n      if (typeof title != \"undefined\" && title !== \"\") {\n        this.div.title = title;\n      }\n\n      if (box.width !== 0 && box.height !== 0) {\n        this.sized = true;\n      } // style.backgroundColor = '#f00'; // debug\n\n\n      if (this.domElement) {\n        this.domElement.appendChild(this.div);\n        this.div.innerHTML = this.getHTML(box.width, box.height).replace(/&/g, '&amp;');\n      }\n    },\n    positionElement: function () {\n      var box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n      var style = this.div.style;\n      style.position = 'absolute'; //style.left = (this.domElement.offsetLeft)+'px';\n      //style.top = this.domElement.offsetTop+'px';\n\n      style.width = box.width + 'px';\n      style.height = box.height + 'px';\n\n      if (box.width !== 0 && box.height !== 0) {\n        this.sized = true;\n      } else {\n        return;\n      }\n\n      var flash = this.div.childNodes[0];\n      flash.width = box.width;\n      flash.height = box.height;\n    },\n    getHTML: function (width, height) {\n      // return HTML for movie\n      var html = '';\n      var flashvars = 'id=' + this.id + '&width=' + width + '&height=' + height;\n\n      if (navigator.userAgent.match(/MSIE/)) {\n        // IE gets an OBJECT tag\n        var protocol = location.href.match(/^https/i) ? 'https://' : 'http://';\n        html += '<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"' + protocol + 'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0\" width=\"' + width + '\" height=\"' + height + '\" id=\"' + this.movieId + '\" align=\"middle\"><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\"' + ZeroClipboard_TableTools.moviePath + '\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\"' + flashvars + '\"/><param name=\"wmode\" value=\"transparent\"/></object>';\n      } else {\n        // all other browsers get an EMBED tag\n        html += '<embed id=\"' + this.movieId + '\" src=\"' + ZeroClipboard_TableTools.moviePath + '\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"' + width + '\" height=\"' + height + '\" name=\"' + this.movieId + '\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"' + flashvars + '\" wmode=\"transparent\" />';\n      }\n\n      return html;\n    },\n    hide: function () {\n      // temporarily hide floater offscreen\n      if (this.div) {\n        this.div.style.left = '-2000px';\n      }\n    },\n    show: function () {\n      // show ourselves after a call to hide()\n      this.reposition();\n    },\n    destroy: function () {\n      // destroy control and floater\n      var that = this;\n\n      if (this.domElement && this.div) {\n        $(this.div).remove();\n        this.domElement = null;\n        this.div = null;\n        $.each(ZeroClipboard_TableTools.clients, function (id, client) {\n          if (client === that) {\n            delete ZeroClipboard_TableTools.clients[id];\n          }\n        });\n      }\n    },\n    reposition: function (elem) {\n      // reposition our floating div, optionally to new container\n      // warning: container CANNOT change size, only position\n      if (elem) {\n        this.domElement = ZeroClipboard_TableTools.$(elem);\n\n        if (!this.domElement) {\n          this.hide();\n        }\n      }\n\n      if (this.domElement && this.div) {\n        var box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n        var style = this.div.style;\n        style.left = '' + box.left + 'px';\n        style.top = '' + box.top + 'px';\n      }\n    },\n    clearText: function () {\n      // clear the text to be copy / saved\n      this.clipText = '';\n\n      if (this.ready) {\n        this.movie.clearText();\n      }\n    },\n    appendText: function (newText) {\n      // append text to that which is to be copied / saved\n      this.clipText += newText;\n\n      if (this.ready) {\n        this.movie.appendText(newText);\n      }\n    },\n    setText: function (newText) {\n      // set text to be copied to be copied / saved\n      this.clipText = newText;\n\n      if (this.ready) {\n        this.movie.setText(newText);\n      }\n    },\n    setFileName: function (newText) {\n      // set the file name\n      this.fileName = newText;\n\n      if (this.ready) {\n        this.movie.setFileName(newText);\n      }\n    },\n    setSheetData: function (data) {\n      // set the xlsx sheet data\n      if (this.ready) {\n        this.movie.setSheetData(JSON.stringify(data));\n      }\n    },\n    setAction: function (newText) {\n      // set action (save or copy)\n      this.action = newText;\n\n      if (this.ready) {\n        this.movie.setAction(newText);\n      }\n    },\n    addEventListener: function (eventName, func) {\n      // add user event listener for event\n      // event types: load, queueStart, fileStart, fileComplete, queueComplete, progress, error, cancel\n      eventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\n      if (!this.handlers[eventName]) {\n        this.handlers[eventName] = [];\n      }\n\n      this.handlers[eventName].push(func);\n    },\n    setHandCursor: function (enabled) {\n      // enable hand cursor (true), or default arrow cursor (false)\n      this.handCursorEnabled = enabled;\n\n      if (this.ready) {\n        this.movie.setHandCursor(enabled);\n      }\n    },\n    setCSSEffects: function (enabled) {\n      // enable or disable CSS effects on DOM container\n      this.cssEffects = !!enabled;\n    },\n    receiveEvent: function (eventName, args) {\n      var self; // receive event from flash\n\n      eventName = eventName.toString().toLowerCase().replace(/^on/, ''); // special behavior for certain events\n\n      switch (eventName) {\n        case 'load':\n          // movie claims it is ready, but in IE this isn't always the case...\n          // bug fix: Cannot extend EMBED DOM elements in Firefox, must use traditional function\n          this.movie = document.getElementById(this.movieId);\n\n          if (!this.movie) {\n            self = this;\n            setTimeout(function () {\n              self.receiveEvent('load', null);\n            }, 1);\n            return;\n          } // firefox on pc needs a \"kick\" in order to set these in certain cases\n\n\n          if (!this.ready && navigator.userAgent.match(/Firefox/) && navigator.userAgent.match(/Windows/)) {\n            self = this;\n            setTimeout(function () {\n              self.receiveEvent('load', null);\n            }, 100);\n            this.ready = true;\n            return;\n          }\n\n          this.ready = true;\n          this.movie.clearText();\n          this.movie.appendText(this.clipText);\n          this.movie.setFileName(this.fileName);\n          this.movie.setAction(this.action);\n          this.movie.setHandCursor(this.handCursorEnabled);\n          break;\n\n        case 'mouseover':\n          if (this.domElement && this.cssEffects) {\n            //this.domElement.addClass('hover');\n            if (this.recoverActive) {\n              this.domElement.addClass('active');\n            }\n          }\n\n          break;\n\n        case 'mouseout':\n          if (this.domElement && this.cssEffects) {\n            this.recoverActive = false;\n\n            if (this.domElement.hasClass('active')) {\n              this.domElement.removeClass('active');\n              this.recoverActive = true;\n            } //this.domElement.removeClass('hover');\n\n          }\n\n          break;\n\n        case 'mousedown':\n          if (this.domElement && this.cssEffects) {\n            this.domElement.addClass('active');\n          }\n\n          break;\n\n        case 'mouseup':\n          if (this.domElement && this.cssEffects) {\n            this.domElement.removeClass('active');\n            this.recoverActive = false;\n          }\n\n          break;\n      } // switch eventName\n\n\n      if (this.handlers[eventName]) {\n        for (var idx = 0, len = this.handlers[eventName].length; idx < len; idx++) {\n          var func = this.handlers[eventName][idx];\n\n          if (typeof func == 'function') {\n            // actual function reference\n            func(this, args);\n          } else if (typeof func == 'object' && func.length == 2) {\n            // PHP style object + method, i.e. [myObject, 'myMethod']\n            func[0][func[1]](this, args);\n          } else if (typeof func == 'string') {\n            // name of function\n            window[func](this, args);\n          }\n        } // foreach event handler defined\n\n      } // user defined handler for event\n\n    }\n  };\n\n  ZeroClipboard_TableTools.hasFlash = function () {\n    try {\n      var fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n\n      if (fo) {\n        return true;\n      }\n    } catch (e) {\n      if (navigator.mimeTypes && navigator.mimeTypes['application/x-shockwave-flash'] !== undefined && navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin) {\n        return true;\n      }\n    }\n\n    return false;\n  }; // For the Flash binding to work, ZeroClipboard_TableTools must be on the global\n  // object list\n\n\n  window.ZeroClipboard_TableTools = ZeroClipboard_TableTools;\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Local (private) functions\n   */\n\n  /**\n   * If a Buttons instance is initlaised before it is placed into the DOM, Flash\n   * won't be able to bind to it, so we need to wait until it is available, this\n   * method abstracts that out.\n   *\n   * @param {ZeroClipboard} flash ZeroClipboard instance\n   * @param {jQuery} node  Button\n   */\n\n  var _glue = function (flash, node) {\n    var id = node.attr('id');\n\n    if (node.parents('html').length) {\n      flash.glue(node[0], '');\n    } else {\n      setTimeout(function () {\n        _glue(flash, node);\n      }, 500);\n    }\n  };\n  /**\n   * Get the sheet name for Excel exports.\n   *\n   * @param {object}  config       Button configuration\n   */\n\n\n  var _sheetname = function (config) {\n    var sheetName = 'Sheet1';\n\n    if (config.sheetName) {\n      sheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n    }\n\n    return sheetName;\n  };\n  /**\n   * Set the flash text. This has to be broken up into chunks as the Javascript /\n   * Flash bridge has a size limit. There is no indication in the Flash\n   * documentation what this is, and it probably depends upon the browser.\n   * Experimentation shows that the point is around 50k when data starts to get\n   * lost, so an 8K limit used here is safe.\n   *\n   * @param {ZeroClipboard} flash ZeroClipboard instance\n   * @param {string}        data  Data to send to Flash\n   */\n\n\n  var _setText = function (flash, data) {\n    var parts = data.match(/[\\s\\S]{1,8192}/g) || [];\n    flash.clearText();\n\n    for (var i = 0, len = parts.length; i < len; i++) {\n      flash.appendText(parts[i]);\n    }\n  };\n  /**\n   * Get the newline character(s)\n   *\n   * @param {object}  config Button configuration\n   * @return {string}        Newline character\n   */\n\n\n  var _newLine = function (config) {\n    return config.newline ? config.newline : navigator.userAgent.match(/Windows/) ? '\\r\\n' : '\\n';\n  };\n  /**\n   * Combine the data from the `buttons.exportData` method into a string that\n   * will be used in the export file.\n   *\n   * @param  {DataTable.Api} dt     DataTables API instance\n   * @param  {object}        config Button configuration\n   * @return {object}               The data to export\n   */\n\n\n  var _exportData = function (dt, config) {\n    var newLine = _newLine(config);\n\n    var data = dt.buttons.exportData(config.exportOptions);\n    var boundary = config.fieldBoundary;\n    var separator = config.fieldSeparator;\n    var reBoundary = new RegExp(boundary, 'g');\n    var escapeChar = config.escapeChar !== undefined ? config.escapeChar : '\\\\';\n\n    var join = function (a) {\n      var s = ''; // If there is a field boundary, then we might need to escape it in\n      // the source data\n\n      for (var i = 0, ien = a.length; i < ien; i++) {\n        if (i > 0) {\n          s += separator;\n        }\n\n        s += boundary ? boundary + ('' + a[i]).replace(reBoundary, escapeChar + boundary) + boundary : a[i];\n      }\n\n      return s;\n    };\n\n    var header = config.header ? join(data.header) + newLine : '';\n    var footer = config.footer && data.footer ? newLine + join(data.footer) : '';\n    var body = [];\n\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      body.push(join(data.body[i]));\n    }\n\n    return {\n      str: header + body.join(newLine) + footer,\n      rows: body.length\n    };\n  }; // Basic initialisation for the buttons is common between them\n\n\n  var flashButton = {\n    available: function () {\n      return ZeroClipboard_TableTools.hasFlash();\n    },\n    init: function (dt, button, config) {\n      // Insert the Flash movie\n      ZeroClipboard_TableTools.moviePath = DataTable.Buttons.swfPath;\n      var flash = new ZeroClipboard_TableTools.Client();\n      flash.setHandCursor(true);\n      flash.addEventListener('mouseDown', function (client) {\n        config._fromFlash = true;\n        dt.button(button[0]).trigger();\n        config._fromFlash = false;\n      });\n\n      _glue(flash, button);\n\n      config._flash = flash;\n    },\n    destroy: function (dt, button, config) {\n      config._flash.destroy();\n    },\n    fieldSeparator: ',',\n    fieldBoundary: '\"',\n    exportOptions: {},\n    title: '*',\n    messageTop: '*',\n    messageBottom: '*',\n    filename: '*',\n    extension: '.csv',\n    header: true,\n    footer: false\n  };\n  /**\n   * Convert from numeric position to letter for column names in Excel\n   * @param  {int} n Column number\n   * @return {string} Column letter(s) name\n   */\n\n  function createCellPos(n) {\n    var ordA = 'A'.charCodeAt(0);\n    var ordZ = 'Z'.charCodeAt(0);\n    var len = ordZ - ordA + 1;\n    var s = \"\";\n\n    while (n >= 0) {\n      s = String.fromCharCode(n % len + ordA) + s;\n      n = Math.floor(n / len) - 1;\n    }\n\n    return s;\n  }\n  /**\n   * Create an XML node and add any children, attributes, etc without needing to\n   * be verbose in the DOM.\n   *\n   * @param  {object} doc      XML document\n   * @param  {string} nodeName Node name\n   * @param  {object} opts     Options - can be `attr` (attributes), `children`\n   *   (child nodes) and `text` (text content)\n   * @return {node}            Created node\n   */\n\n\n  function _createNode(doc, nodeName, opts) {\n    var tempNode = doc.createElement(nodeName);\n\n    if (opts) {\n      if (opts.attr) {\n        $(tempNode).attr(opts.attr);\n      }\n\n      if (opts.children) {\n        $.each(opts.children, function (key, value) {\n          tempNode.appendChild(value);\n        });\n      }\n\n      if (opts.text !== null && opts.text !== undefined) {\n        tempNode.appendChild(doc.createTextNode(opts.text));\n      }\n    }\n\n    return tempNode;\n  }\n  /**\n   * Get the width for an Excel column based on the contents of that column\n   * @param  {object} data Data for export\n   * @param  {int}    col  Column index\n   * @return {int}         Column width\n   */\n\n\n  function _excelColWidth(data, col) {\n    var max = data.header[col].length;\n    var len, lineSplit, str;\n\n    if (data.footer && data.footer[col].length > max) {\n      max = data.footer[col].length;\n    }\n\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      var point = data.body[i][col];\n      str = point !== null && point !== undefined ? point.toString() : ''; // If there is a newline character, workout the width of the column\n      // based on the longest line in the string\n\n      if (str.indexOf('\\n') !== -1) {\n        lineSplit = str.split('\\n');\n        lineSplit.sort(function (a, b) {\n          return b.length - a.length;\n        });\n        len = lineSplit[0].length;\n      } else {\n        len = str.length;\n      }\n\n      if (len > max) {\n        max = len;\n      } // Max width rather than having potentially massive column widths\n\n\n      if (max > 40) {\n        return 52; // 40 * 1.3\n      }\n    }\n\n    max *= 1.3; // And a min width\n\n    return max > 6 ? max : 6;\n  }\n\n  var _serialiser = \"\";\n\n  if (typeof window.XMLSerializer === 'undefined') {\n    _serialiser = new function () {\n      this.serializeToString = function (input) {\n        return input.xml;\n      };\n    }();\n  } else {\n    _serialiser = new XMLSerializer();\n  }\n\n  var _ieExcel;\n  /**\n   * Convert XML documents in an object to strings\n   * @param  {object} obj XLSX document object\n   */\n\n\n  function _xlsxToStrings(obj) {\n    if (_ieExcel === undefined) {\n      // Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n      // drop attributes\n      _ieExcel = _serialiser.serializeToString($.parseXML(excelStrings['xl/worksheets/sheet1.xml'])).indexOf('xmlns:r') === -1;\n    }\n\n    $.each(obj, function (name, val) {\n      if ($.isPlainObject(val)) {\n        _xlsxToStrings(val);\n      } else {\n        if (_ieExcel) {\n          // IE's XML serialiser will drop some name space attributes from\n          // from the root node, so we need to save them. Do this by\n          // replacing the namespace nodes with a regular attribute that\n          // we convert back when serialised. Edge does not have this\n          // issue\n          var worksheet = val.childNodes[0];\n          var i, ien;\n          var attrs = [];\n\n          for (i = worksheet.attributes.length - 1; i >= 0; i--) {\n            var attrName = worksheet.attributes[i].nodeName;\n            var attrValue = worksheet.attributes[i].nodeValue;\n\n            if (attrName.indexOf(':') !== -1) {\n              attrs.push({\n                name: attrName,\n                value: attrValue\n              });\n              worksheet.removeAttribute(attrName);\n            }\n          }\n\n          for (i = 0, ien = attrs.length; i < ien; i++) {\n            var attr = val.createAttribute(attrs[i].name.replace(':', '_dt_b_namespace_token_'));\n            attr.value = attrs[i].value;\n            worksheet.setAttributeNode(attr);\n          }\n        }\n\n        var str = _serialiser.serializeToString(val); // Fix IE's XML\n\n\n        if (_ieExcel) {\n          // IE doesn't include the XML declaration\n          if (str.indexOf('<?xml') === -1) {\n            str = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + str;\n          } // Return namespace attributes to being as such\n\n\n          str = str.replace(/_dt_b_namespace_token_/g, ':');\n        } // Safari, IE and Edge will put empty name space attributes onto\n        // various elements making them useless. This strips them out\n\n\n        str = str.replace(/<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>');\n        obj[name] = str;\n      }\n    });\n  } // Excel - Pre-defined strings to build a basic XLSX file\n\n\n  var excelStrings = {\n    \"_rels/.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' + '</Relationships>',\n    \"xl/_rels/workbook.xml.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' + '</Relationships>',\n    \"[Content_Types].xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' + '<Default Extension=\"xml\" ContentType=\"application/xml\" />' + '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />' + '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />' + '<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />' + '<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />' + '<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />' + '</Types>',\n    \"xl/workbook.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' + '<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>' + '<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>' + '<bookViews>' + '<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>' + '</bookViews>' + '<sheets>' + '<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>' + '</sheets>' + '</workbook>',\n    \"xl/worksheets/sheet1.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<sheetData/>' + '<mergeCells count=\"0\"/>' + '</worksheet>',\n    \"xl/styles.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' + '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<numFmts count=\"6\">' + '<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>' + '<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>' + '<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>' + '<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>' + '<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>' + '<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>' + '</numFmts>' + '<fonts count=\"5\" x14ac:knownFonts=\"1\">' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<color rgb=\"FFFFFFFF\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<b />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<i />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<u />' + '</font>' + '</fonts>' + '<fills count=\"6\">' + '<fill>' + '<patternFill patternType=\"none\" />' + '</fill>' + '<fill>' + // Excel appears to use this as a dotted background regardless of values but\n    '<patternFill patternType=\"none\" />' + // to be valid to the schema, use a patternFill\n    '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD9D9D9\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD99795\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6efce\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6cfef\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '</fills>' + '<borders count=\"2\">' + '<border>' + '<left />' + '<right />' + '<top />' + '<bottom />' + '<diagonal />' + '</border>' + '<border diagonalUp=\"false\" diagonalDown=\"false\">' + '<left style=\"thin\">' + '<color auto=\"1\" />' + '</left>' + '<right style=\"thin\">' + '<color auto=\"1\" />' + '</right>' + '<top style=\"thin\">' + '<color auto=\"1\" />' + '</top>' + '<bottom style=\"thin\">' + '<color auto=\"1\" />' + '</bottom>' + '<diagonal />' + '</border>' + '</borders>' + '<cellStyleXfs count=\"1\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />' + '</cellStyleXfs>' + '<cellXfs count=\"61\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"left\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"center\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"right\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"fill\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment textRotation=\"90\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment wrapText=\"1\"/>' + '</xf>' + '<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '</cellXfs>' + '<cellStyles count=\"1\">' + '<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />' + '</cellStyles>' + '<dxfs count=\"0\" />' + '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />' + '</styleSheet>'\n  }; // Note we could use 3 `for` loops for the styles, but when gzipped there is\n  // virtually no difference in size, since the above can be easily compressed\n  // Pattern matching for special number formats. Perhaps this should be exposed\n  // via an API in future?\n\n  var _excelSpecials = [{\n    match: /^\\-?\\d+\\.\\d%$/,\n    style: 60,\n    fmt: function (d) {\n      return d / 100;\n    }\n  }, // Precent with d.p.\n  {\n    match: /^\\-?\\d+\\.?\\d*%$/,\n    style: 56,\n    fmt: function (d) {\n      return d / 100;\n    }\n  }, // Percent\n  {\n    match: /^\\-?\\$[\\d,]+.?\\d*$/,\n    style: 57\n  }, // Dollars\n  {\n    match: /^\\-?£[\\d,]+.?\\d*$/,\n    style: 58\n  }, // Pounds\n  {\n    match: /^\\-?€[\\d,]+.?\\d*$/,\n    style: 59\n  }, // Euros\n  {\n    match: /^\\([\\d,]+\\)$/,\n    style: 61,\n    fmt: function (d) {\n      return -1 * d.replace(/[\\(\\)]/g, '');\n    }\n  }, // Negative numbers indicated by brackets\n  {\n    match: /^\\([\\d,]+\\.\\d{2}\\)$/,\n    style: 62,\n    fmt: function (d) {\n      return -1 * d.replace(/[\\(\\)]/g, '');\n    }\n  }, // Negative numbers indicated by brackets - 2d.p.\n  {\n    match: /^[\\d,]+$/,\n    style: 63\n  }, // Numbers with thousand separators\n  {\n    match: /^[\\d,]+\\.\\d{2}$/,\n    style: 64\n  } // Numbers with 2d.p. and thousands separators\n  ];\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * DataTables options and methods\n   */\n  // Set the default SWF path\n\n  DataTable.Buttons.swfPath = '//cdn.datatables.net/buttons/' + DataTable.Buttons.version + '/swf/flashExport.swf'; // Method to allow Flash buttons to be resized when made visible - as they are\n  // of zero height and width if initialised hidden\n\n  DataTable.Api.register('buttons.resize()', function () {\n    $.each(ZeroClipboard_TableTools.clients, function (i, client) {\n      if (client.domElement !== undefined && client.domElement.parentNode) {\n        client.positionElement();\n      }\n    });\n  });\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Button definitions\n   */\n  // Copy to clipboard\n\n  DataTable.ext.buttons.copyFlash = $.extend({}, flashButton, {\n    className: 'buttons-copy buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.copy', 'Copy');\n    },\n    action: function (e, dt, button, config) {\n      // Check that the trigger did actually occur due to a Flash activation\n      if (!config._fromFlash) {\n        return;\n      }\n\n      this.processing(true);\n      var flash = config._flash;\n\n      var exportData = _exportData(dt, config);\n\n      var info = dt.buttons.exportInfo(config);\n\n      var newline = _newLine(config);\n\n      var output = exportData.str;\n\n      if (info.title) {\n        output = info.title + newline + newline + output;\n      }\n\n      if (info.messageTop) {\n        output = info.messageTop + newline + newline + output;\n      }\n\n      if (info.messageBottom) {\n        output = output + newline + newline + info.messageBottom;\n      }\n\n      if (config.customize) {\n        output = config.customize(output, config, dt);\n      }\n\n      flash.setAction('copy');\n\n      _setText(flash, output);\n\n      this.processing(false);\n      dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), dt.i18n('buttons.copySuccess', {\n        _: 'Copied %d rows to clipboard',\n        1: 'Copied 1 row to clipboard'\n      }, data.rows), 3000);\n    },\n    fieldSeparator: '\\t',\n    fieldBoundary: ''\n  }); // CSV save file\n\n  DataTable.ext.buttons.csvFlash = $.extend({}, flashButton, {\n    className: 'buttons-csv buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.csv', 'CSV');\n    },\n    action: function (e, dt, button, config) {\n      // Set the text\n      var flash = config._flash;\n\n      var data = _exportData(dt, config);\n\n      var info = dt.buttons.exportInfo(config);\n      var output = config.customize ? config.customize(data.str, config, dt) : data.str;\n      flash.setAction('csv');\n      flash.setFileName(info.filename);\n\n      _setText(flash, output);\n    },\n    escapeChar: '\"'\n  }); // Excel save file - this is really a CSV file using UTF-8 that Excel can read\n\n  DataTable.ext.buttons.excelFlash = $.extend({}, flashButton, {\n    className: 'buttons-excel buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.excel', 'Excel');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true);\n      var flash = config._flash;\n      var rowPos = 0;\n      var rels = $.parseXML(excelStrings['xl/worksheets/sheet1.xml']); //Parses xml\n\n      var relsGet = rels.getElementsByTagName(\"sheetData\")[0];\n      var xlsx = {\n        _rels: {\n          \".rels\": $.parseXML(excelStrings['_rels/.rels'])\n        },\n        xl: {\n          _rels: {\n            \"workbook.xml.rels\": $.parseXML(excelStrings['xl/_rels/workbook.xml.rels'])\n          },\n          \"workbook.xml\": $.parseXML(excelStrings['xl/workbook.xml']),\n          \"styles.xml\": $.parseXML(excelStrings['xl/styles.xml']),\n          \"worksheets\": {\n            \"sheet1.xml\": rels\n          }\n        },\n        \"[Content_Types].xml\": $.parseXML(excelStrings['[Content_Types].xml'])\n      };\n      var data = dt.buttons.exportData(config.exportOptions);\n      var currentRow, rowNode;\n\n      var addRow = function (row) {\n        currentRow = rowPos + 1;\n        rowNode = _createNode(rels, \"row\", {\n          attr: {\n            r: currentRow\n          }\n        });\n\n        for (var i = 0, ien = row.length; i < ien; i++) {\n          // Concat both the Cell Columns as a letter and the Row of the cell.\n          var cellId = createCellPos(i) + '' + currentRow;\n          var cell = null; // For null, undefined of blank cell, continue so it doesn't create the _createNode\n\n          if (row[i] === null || row[i] === undefined || row[i] === '') {\n            if (config.createEmptyCells === true) {\n              row[i] = '';\n            } else {\n              continue;\n            }\n          }\n\n          row[i] = typeof row[i].trim === 'function' ? row[i].trim() : row[i]; // Special number formatting options\n\n          for (var j = 0, jen = _excelSpecials.length; j < jen; j++) {\n            var special = _excelSpecials[j]; // TODO Need to provide the ability for the specials to say\n            // if they are returning a string, since at the moment it is\n            // assumed to be a number\n\n            if (row[i].match && !row[i].match(/^0\\d+/) && row[i].match(special.match)) {\n              var val = row[i].replace(/[^\\d\\.\\-]/g, '');\n\n              if (special.fmt) {\n                val = special.fmt(val);\n              }\n\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  r: cellId,\n                  s: special.style\n                },\n                children: [_createNode(rels, 'v', {\n                  text: val\n                })]\n              });\n              break;\n            }\n          }\n\n          if (!cell) {\n            if (typeof row[i] === 'number' || row[i].match && row[i].match(/^-?\\d+(\\.\\d+)?$/) && !row[i].match(/^0\\d+/)) {\n              // Detect numbers - don't match numbers with leading zeros\n              // or a negative anywhere but the start\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  t: 'n',\n                  r: cellId\n                },\n                children: [_createNode(rels, 'v', {\n                  text: row[i]\n                })]\n              });\n            } else {\n              // String output - replace non standard characters for text output\n              var text = !row[i].replace ? row[i] : row[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  t: 'inlineStr',\n                  r: cellId\n                },\n                children: {\n                  row: _createNode(rels, 'is', {\n                    children: {\n                      row: _createNode(rels, 't', {\n                        text: text\n                      })\n                    }\n                  })\n                }\n              });\n            }\n          }\n\n          rowNode.appendChild(cell);\n        }\n\n        relsGet.appendChild(rowNode);\n        rowPos++;\n      };\n\n      $('sheets sheet', xlsx.xl['workbook.xml']).attr('name', _sheetname(config));\n\n      if (config.customizeData) {\n        config.customizeData(data);\n      }\n\n      var mergeCells = function (row, colspan) {\n        var mergeCells = $('mergeCells', rels);\n        mergeCells[0].appendChild(_createNode(rels, 'mergeCell', {\n          attr: {\n            ref: 'A' + row + ':' + createCellPos(colspan) + row\n          }\n        }));\n        mergeCells.attr('count', mergeCells.attr('count') + 1);\n        $('row:eq(' + (row - 1) + ') c', rels).attr('s', '51'); // centre\n      }; // Title and top messages\n\n\n      var exportInfo = dt.buttons.exportInfo(config);\n\n      if (exportInfo.title) {\n        addRow([exportInfo.title], rowPos);\n        mergeCells(rowPos, data.header.length - 1);\n      }\n\n      if (exportInfo.messageTop) {\n        addRow([exportInfo.messageTop], rowPos);\n        mergeCells(rowPos, data.header.length - 1);\n      } // Table itself\n\n\n      if (config.header) {\n        addRow(data.header, rowPos);\n        $('row:last c', rels).attr('s', '2'); // bold\n      }\n\n      for (var n = 0, ie = data.body.length; n < ie; n++) {\n        addRow(data.body[n], rowPos);\n      }\n\n      if (config.footer && data.footer) {\n        addRow(data.footer, rowPos);\n        $('row:last c', rels).attr('s', '2'); // bold\n      } // Below the table\n\n\n      if (exportInfo.messageBottom) {\n        addRow([exportInfo.messageBottom], rowPos);\n        mergeCells(rowPos, data.header.length - 1);\n      } // Set column widths\n\n\n      var cols = _createNode(rels, 'cols');\n\n      $('worksheet', rels).prepend(cols);\n\n      for (var i = 0, ien = data.header.length; i < ien; i++) {\n        cols.appendChild(_createNode(rels, 'col', {\n          attr: {\n            min: i + 1,\n            max: i + 1,\n            width: _excelColWidth(data, i),\n            customWidth: 1\n          }\n        }));\n      } // Let the developer customise the document if they want to\n\n\n      if (config.customize) {\n        config.customize(xlsx, config, dt);\n      }\n\n      _xlsxToStrings(xlsx);\n\n      flash.setAction('excel');\n      flash.setFileName(exportInfo.filename);\n      flash.setSheetData(xlsx);\n\n      _setText(flash, '');\n\n      this.processing(false);\n    },\n    extension: '.xlsx',\n    createEmptyCells: false\n  }); // PDF export\n\n  DataTable.ext.buttons.pdfFlash = $.extend({}, flashButton, {\n    className: 'buttons-pdf buttons-flash',\n    text: function (dt) {\n      return dt.i18n('buttons.pdf', 'PDF');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true); // Set the text\n\n      var flash = config._flash;\n      var data = dt.buttons.exportData(config.exportOptions);\n      var info = dt.buttons.exportInfo(config);\n      var totalWidth = dt.table().node().offsetWidth; // Calculate the column width ratios for layout of the table in the PDF\n\n      var ratios = dt.columns(config.columns).indexes().map(function (idx) {\n        return dt.column(idx).header().offsetWidth / totalWidth;\n      });\n      flash.setAction('pdf');\n      flash.setFileName(info.filename);\n\n      _setText(flash, JSON.stringify({\n        title: info.title || '',\n        messageTop: info.messageTop || '',\n        messageBottom: info.messageBottom || '',\n        colWidth: ratios.toArray(),\n        orientation: config.orientation,\n        size: config.pageSize,\n        header: config.header ? data.header : null,\n        footer: config.footer ? data.footer : null,\n        body: data.body\n      }));\n\n      this.processing(false);\n    },\n    extension: '.pdf',\n    orientation: 'portrait',\n    pageSize: 'A4',\n    newline: '\\n'\n  });\n  return DataTable.Buttons;\n});","map":{"version":3,"sources":["/Users/mac/Desktop/tokunbojames_erp/node_modules/datatables.net-buttons/js/buttons.flash.js"],"names":["factory","define","amd","$","window","document","exports","module","root","fn","dataTable","require","Buttons","jQuery","undefined","DataTable","ZeroClipboard_TableTools","version","clients","moviePath","nextId","thingy","getElementById","addClass","hide","style","display","show","name","removeClass","className","replace","RegExp","hasClass","match","setMoviePath","path","dispatch","id","eventName","args","client","receiveEvent","log","str","console","register","getDOMObjectPosition","obj","info","left","top","width","offsetWidth","height","offsetHeight","offsetLeft","offsetTop","offsetParent","Client","elem","handlers","movieId","glue","prototype","ready","movie","clipText","fileName","action","handCursorEnabled","cssEffects","sized","sheetName","title","domElement","zIndex","parseInt","box","div","createElement","position","appendChild","innerHTML","getHTML","positionElement","flash","childNodes","html","flashvars","navigator","userAgent","protocol","location","href","reposition","destroy","that","remove","each","clearText","appendText","newText","setText","setFileName","setSheetData","data","JSON","stringify","setAction","addEventListener","func","toString","toLowerCase","push","setHandCursor","enabled","setCSSEffects","self","setTimeout","recoverActive","idx","len","length","hasFlash","fo","ActiveXObject","e","mimeTypes","enabledPlugin","_glue","node","attr","parents","_sheetname","config","_setText","parts","i","_newLine","newline","_exportData","dt","newLine","buttons","exportData","exportOptions","boundary","fieldBoundary","separator","fieldSeparator","reBoundary","escapeChar","join","a","s","ien","header","footer","body","rows","flashButton","available","init","button","swfPath","_fromFlash","trigger","_flash","messageTop","messageBottom","filename","extension","createCellPos","n","ordA","charCodeAt","ordZ","String","fromCharCode","Math","floor","_createNode","doc","nodeName","opts","tempNode","children","key","value","text","createTextNode","_excelColWidth","col","max","lineSplit","point","indexOf","split","sort","b","_serialiser","XMLSerializer","serializeToString","input","xml","_ieExcel","_xlsxToStrings","parseXML","excelStrings","val","isPlainObject","worksheet","attrs","attributes","attrName","attrValue","nodeValue","removeAttribute","createAttribute","setAttributeNode","_excelSpecials","fmt","d","Api","parentNode","ext","copyFlash","extend","i18n","processing","exportInfo","output","customize","_","csvFlash","excelFlash","rowPos","rels","relsGet","getElementsByTagName","xlsx","_rels","xl","currentRow","rowNode","addRow","row","r","cellId","cell","createEmptyCells","trim","j","jen","special","t","customizeData","mergeCells","colspan","ref","ie","cols","prepend","min","customWidth","pdfFlash","totalWidth","table","ratios","columns","indexes","map","column","colWidth","toArray","orientation","size","pageSize"],"mappings":"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","sourcesContent":["/*!\n * Flash export buttons for Buttons and DataTables.\n * 2015-2017 SpryMedia Ltd - datatables.net/license\n *\n * ZeroClipbaord - MIT license\n * Copyright (c) 2012 Joseph Huckaby\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'datatables.net', 'datatables.net-buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = function (root, $) {\n\t\t\tif ( ! root ) {\n\t\t\t\troot = window;\n\t\t\t}\n\n\t\t\tif ( ! $ || ! $.fn.dataTable ) {\n\t\t\t\t$ = require('datatables.net')(root, $).$;\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('datatables.net-buttons')(root, $);\n\t\t\t}\n\n\t\t\treturn factory( $, root, root.document );\n\t\t};\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document, undefined ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * ZeroClipboard dependency\n */\n\n/*\n * ZeroClipboard 1.0.4 with modifications\n * Author: Joseph Huckaby\n * License: MIT\n *\n * Copyright (c) 2012 Joseph Huckaby\n */\nvar ZeroClipboard_TableTools = {\n\tversion: \"1.0.4-TableTools2\",\n\tclients: {}, // registered upload clients on page, indexed by id\n\tmoviePath: '', // URL to movie\n\tnextId: 1, // ID of next movie\n\n\t$: function(thingy) {\n\t\t// simple DOM lookup utility function\n\t\tif (typeof(thingy) == 'string') {\n\t\t\tthingy = document.getElementById(thingy);\n\t\t}\n\t\tif (!thingy.addClass) {\n\t\t\t// extend element with a few useful methods\n\t\t\tthingy.hide = function() { this.style.display = 'none'; };\n\t\t\tthingy.show = function() { this.style.display = ''; };\n\t\t\tthingy.addClass = function(name) { this.removeClass(name); this.className += ' ' + name; };\n\t\t\tthingy.removeClass = function(name) {\n\t\t\t\tthis.className = this.className.replace( new RegExp(\"\\\\s*\" + name + \"\\\\s*\"), \" \").replace(/^\\s+/, '').replace(/\\s+$/, '');\n\t\t\t};\n\t\t\tthingy.hasClass = function(name) {\n\t\t\t\treturn !!this.className.match( new RegExp(\"\\\\s*\" + name + \"\\\\s*\") );\n\t\t\t};\n\t\t}\n\t\treturn thingy;\n\t},\n\n\tsetMoviePath: function(path) {\n\t\t// set path to ZeroClipboard.swf\n\t\tthis.moviePath = path;\n\t},\n\n\tdispatch: function(id, eventName, args) {\n\t\t// receive event from flash movie, send to client\n\t\tvar client = this.clients[id];\n\t\tif (client) {\n\t\t\tclient.receiveEvent(eventName, args);\n\t\t}\n\t},\n\n\tlog: function ( str ) {\n\t\tconsole.log( 'Flash: '+str );\n\t},\n\n\tregister: function(id, client) {\n\t\t// register new client to receive events\n\t\tthis.clients[id] = client;\n\t},\n\n\tgetDOMObjectPosition: function(obj) {\n\t\t// get absolute coordinates for dom element\n\t\tvar info = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: obj.width ? obj.width : obj.offsetWidth,\n\t\t\theight: obj.height ? obj.height : obj.offsetHeight\n\t\t};\n\n\t\tif ( obj.style.width !== \"\" ) {\n\t\t\tinfo.width = obj.style.width.replace(\"px\",\"\");\n\t\t}\n\n\t\tif ( obj.style.height !== \"\" ) {\n\t\t\tinfo.height = obj.style.height.replace(\"px\",\"\");\n\t\t}\n\n\t\twhile (obj) {\n\t\t\tinfo.left += obj.offsetLeft;\n\t\t\tinfo.top += obj.offsetTop;\n\t\t\tobj = obj.offsetParent;\n\t\t}\n\n\t\treturn info;\n\t},\n\n\tClient: function(elem) {\n\t\t// constructor for new simple upload client\n\t\tthis.handlers = {};\n\n\t\t// unique ID\n\t\tthis.id = ZeroClipboard_TableTools.nextId++;\n\t\tthis.movieId = 'ZeroClipboard_TableToolsMovie_' + this.id;\n\n\t\t// register client with singleton to receive flash events\n\t\tZeroClipboard_TableTools.register(this.id, this);\n\n\t\t// create movie\n\t\tif (elem) {\n\t\t\tthis.glue(elem);\n\t\t}\n\t}\n};\n\nZeroClipboard_TableTools.Client.prototype = {\n\n\tid: 0, // unique ID for us\n\tready: false, // whether movie is ready to receive events or not\n\tmovie: null, // reference to movie object\n\tclipText: '', // text to copy to clipboard\n\tfileName: '', // default file save name\n\taction: 'copy', // action to perform\n\thandCursorEnabled: true, // whether to show hand cursor, or default pointer cursor\n\tcssEffects: true, // enable CSS mouse effects on dom container\n\thandlers: null, // user event handlers\n\tsized: false,\n\tsheetName: '', // default sheet name for excel export\n\n\tglue: function(elem, title) {\n\t\t// glue to DOM element\n\t\t// elem can be ID or actual DOM element object\n\t\tthis.domElement = ZeroClipboard_TableTools.$(elem);\n\n\t\t// float just above object, or zIndex 99 if dom element isn't set\n\t\tvar zIndex = 99;\n\t\tif (this.domElement.style.zIndex) {\n\t\t\tzIndex = parseInt(this.domElement.style.zIndex, 10) + 1;\n\t\t}\n\n\t\t// find X/Y position of domElement\n\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\n\t\t// create floating DIV above element\n\t\tthis.div = document.createElement('div');\n\t\tvar style = this.div.style;\n\t\tstyle.position = 'absolute';\n\t\tstyle.left = '0px';\n\t\tstyle.top = '0px';\n\t\tstyle.width = (box.width) + 'px';\n\t\tstyle.height = box.height + 'px';\n\t\tstyle.zIndex = zIndex;\n\n\t\tif ( typeof title != \"undefined\" && title !== \"\" ) {\n\t\t\tthis.div.title = title;\n\t\t}\n\t\tif ( box.width !== 0 && box.height !== 0 ) {\n\t\t\tthis.sized = true;\n\t\t}\n\n\t\t// style.backgroundColor = '#f00'; // debug\n\t\tif ( this.domElement ) {\n\t\t\tthis.domElement.appendChild(this.div);\n\t\t\tthis.div.innerHTML = this.getHTML( box.width, box.height ).replace(/&/g, '&amp;');\n\t\t}\n\t},\n\n\tpositionElement: function() {\n\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\t\tvar style = this.div.style;\n\n\t\tstyle.position = 'absolute';\n\t\t//style.left = (this.domElement.offsetLeft)+'px';\n\t\t//style.top = this.domElement.offsetTop+'px';\n\t\tstyle.width = box.width + 'px';\n\t\tstyle.height = box.height + 'px';\n\n\t\tif ( box.width !== 0 && box.height !== 0 ) {\n\t\t\tthis.sized = true;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tvar flash = this.div.childNodes[0];\n\t\tflash.width = box.width;\n\t\tflash.height = box.height;\n\t},\n\n\tgetHTML: function(width, height) {\n\t\t// return HTML for movie\n\t\tvar html = '';\n\t\tvar flashvars = 'id=' + this.id +\n\t\t\t'&width=' + width +\n\t\t\t'&height=' + height;\n\n\t\tif (navigator.userAgent.match(/MSIE/)) {\n\t\t\t// IE gets an OBJECT tag\n\t\t\tvar protocol = location.href.match(/^https/i) ? 'https://' : 'http://';\n\t\t\thtml += '<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"'+protocol+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0\" width=\"'+width+'\" height=\"'+height+'\" id=\"'+this.movieId+'\" align=\"middle\"><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\"'+ZeroClipboard_TableTools.moviePath+'\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\"'+flashvars+'\"/><param name=\"wmode\" value=\"transparent\"/></object>';\n\t\t}\n\t\telse {\n\t\t\t// all other browsers get an EMBED tag\n\t\t\thtml += '<embed id=\"'+this.movieId+'\" src=\"'+ZeroClipboard_TableTools.moviePath+'\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"'+width+'\" height=\"'+height+'\" name=\"'+this.movieId+'\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"'+flashvars+'\" wmode=\"transparent\" />';\n\t\t}\n\t\treturn html;\n\t},\n\n\thide: function() {\n\t\t// temporarily hide floater offscreen\n\t\tif (this.div) {\n\t\t\tthis.div.style.left = '-2000px';\n\t\t}\n\t},\n\n\tshow: function() {\n\t\t// show ourselves after a call to hide()\n\t\tthis.reposition();\n\t},\n\n\tdestroy: function() {\n\t\t// destroy control and floater\n\t\tvar that = this;\n\n\t\tif (this.domElement && this.div) {\n\t\t\t$(this.div).remove();\n\n\t\t\tthis.domElement = null;\n\t\t\tthis.div = null;\n\n\t\t\t$.each( ZeroClipboard_TableTools.clients, function ( id, client ) {\n\t\t\t\tif ( client === that ) {\n\t\t\t\t\tdelete ZeroClipboard_TableTools.clients[ id ];\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t},\n\n\treposition: function(elem) {\n\t\t// reposition our floating div, optionally to new container\n\t\t// warning: container CANNOT change size, only position\n\t\tif (elem) {\n\t\t\tthis.domElement = ZeroClipboard_TableTools.$(elem);\n\t\t\tif (!this.domElement) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\n\t\tif (this.domElement && this.div) {\n\t\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\t\t\tvar style = this.div.style;\n\t\t\tstyle.left = '' + box.left + 'px';\n\t\t\tstyle.top = '' + box.top + 'px';\n\t\t}\n\t},\n\n\tclearText: function() {\n\t\t// clear the text to be copy / saved\n\t\tthis.clipText = '';\n\t\tif (this.ready) {\n\t\t\tthis.movie.clearText();\n\t\t}\n\t},\n\n\tappendText: function(newText) {\n\t\t// append text to that which is to be copied / saved\n\t\tthis.clipText += newText;\n\t\tif (this.ready) { this.movie.appendText(newText) ;}\n\t},\n\n\tsetText: function(newText) {\n\t\t// set text to be copied to be copied / saved\n\t\tthis.clipText = newText;\n\t\tif (this.ready) { this.movie.setText(newText) ;}\n\t},\n\n\tsetFileName: function(newText) {\n\t\t// set the file name\n\t\tthis.fileName = newText;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setFileName(newText);\n\t\t}\n\t},\n\n\tsetSheetData: function(data) {\n\t\t// set the xlsx sheet data\n\t\tif (this.ready) {\n\t\t\tthis.movie.setSheetData( JSON.stringify( data ) );\n\t\t}\n\t},\n\n\tsetAction: function(newText) {\n\t\t// set action (save or copy)\n\t\tthis.action = newText;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setAction(newText);\n\t\t}\n\t},\n\n\taddEventListener: function(eventName, func) {\n\t\t// add user event listener for event\n\t\t// event types: load, queueStart, fileStart, fileComplete, queueComplete, progress, error, cancel\n\t\teventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\t\tif (!this.handlers[eventName]) {\n\t\t\tthis.handlers[eventName] = [];\n\t\t}\n\t\tthis.handlers[eventName].push(func);\n\t},\n\n\tsetHandCursor: function(enabled) {\n\t\t// enable hand cursor (true), or default arrow cursor (false)\n\t\tthis.handCursorEnabled = enabled;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setHandCursor(enabled);\n\t\t}\n\t},\n\n\tsetCSSEffects: function(enabled) {\n\t\t// enable or disable CSS effects on DOM container\n\t\tthis.cssEffects = !!enabled;\n\t},\n\n\treceiveEvent: function(eventName, args) {\n\t\tvar self;\n\n\t\t// receive event from flash\n\t\teventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\n\t\t// special behavior for certain events\n\t\tswitch (eventName) {\n\t\t\tcase 'load':\n\t\t\t\t// movie claims it is ready, but in IE this isn't always the case...\n\t\t\t\t// bug fix: Cannot extend EMBED DOM elements in Firefox, must use traditional function\n\t\t\t\tthis.movie = document.getElementById(this.movieId);\n\t\t\t\tif (!this.movie) {\n\t\t\t\t\tself = this;\n\t\t\t\t\tsetTimeout( function() { self.receiveEvent('load', null); }, 1 );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// firefox on pc needs a \"kick\" in order to set these in certain cases\n\t\t\t\tif (!this.ready && navigator.userAgent.match(/Firefox/) && navigator.userAgent.match(/Windows/)) {\n\t\t\t\t\tself = this;\n\t\t\t\t\tsetTimeout( function() { self.receiveEvent('load', null); }, 100 );\n\t\t\t\t\tthis.ready = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.ready = true;\n\t\t\t\tthis.movie.clearText();\n\t\t\t\tthis.movie.appendText( this.clipText );\n\t\t\t\tthis.movie.setFileName( this.fileName );\n\t\t\t\tthis.movie.setAction( this.action );\n\t\t\t\tthis.movie.setHandCursor( this.handCursorEnabled );\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseover':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\t//this.domElement.addClass('hover');\n\t\t\t\t\tif (this.recoverActive) {\n\t\t\t\t\t\tthis.domElement.addClass('active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseout':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.recoverActive = false;\n\t\t\t\t\tif (this.domElement.hasClass('active')) {\n\t\t\t\t\t\tthis.domElement.removeClass('active');\n\t\t\t\t\t\tthis.recoverActive = true;\n\t\t\t\t\t}\n\t\t\t\t\t//this.domElement.removeClass('hover');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mousedown':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.domElement.addClass('active');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseup':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.domElement.removeClass('active');\n\t\t\t\t\tthis.recoverActive = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t} // switch eventName\n\n\t\tif (this.handlers[eventName]) {\n\t\t\tfor (var idx = 0, len = this.handlers[eventName].length; idx < len; idx++) {\n\t\t\t\tvar func = this.handlers[eventName][idx];\n\n\t\t\t\tif (typeof(func) == 'function') {\n\t\t\t\t\t// actual function reference\n\t\t\t\t\tfunc(this, args);\n\t\t\t\t}\n\t\t\t\telse if ((typeof(func) == 'object') && (func.length == 2)) {\n\t\t\t\t\t// PHP style object + method, i.e. [myObject, 'myMethod']\n\t\t\t\t\tfunc[0][ func[1] ](this, args);\n\t\t\t\t}\n\t\t\t\telse if (typeof(func) == 'string') {\n\t\t\t\t\t// name of function\n\t\t\t\t\twindow[func](this, args);\n\t\t\t\t}\n\t\t\t} // foreach event handler defined\n\t\t} // user defined handler for event\n\t}\n};\n\nZeroClipboard_TableTools.hasFlash = function ()\n{\n\ttry {\n\t\tvar fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n\t\tif (fo) {\n\t\t\treturn true;\n\t\t}\n\t}\n\tcatch (e) {\n\t\tif (\n\t\t\tnavigator.mimeTypes &&\n\t\t\tnavigator.mimeTypes['application/x-shockwave-flash'] !== undefined &&\n\t\t\tnavigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\n// For the Flash binding to work, ZeroClipboard_TableTools must be on the global\n// object list\nwindow.ZeroClipboard_TableTools = ZeroClipboard_TableTools;\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Local (private) functions\n */\n\n/**\n * If a Buttons instance is initlaised before it is placed into the DOM, Flash\n * won't be able to bind to it, so we need to wait until it is available, this\n * method abstracts that out.\n *\n * @param {ZeroClipboard} flash ZeroClipboard instance\n * @param {jQuery} node  Button\n */\nvar _glue = function ( flash, node )\n{\n\tvar id = node.attr('id');\n\n\tif ( node.parents('html').length ) {\n\t\tflash.glue( node[0], '' );\n\t}\n\telse {\n\t\tsetTimeout( function () {\n\t\t\t_glue( flash, node );\n\t\t}, 500 );\n\t}\n};\n\n/**\n * Get the sheet name for Excel exports.\n *\n * @param {object}  config       Button configuration\n */\nvar _sheetname = function ( config )\n{\n\tvar sheetName = 'Sheet1';\n\n\tif ( config.sheetName ) {\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n\t}\n\n\treturn sheetName;\n};\n\n/**\n * Set the flash text. This has to be broken up into chunks as the Javascript /\n * Flash bridge has a size limit. There is no indication in the Flash\n * documentation what this is, and it probably depends upon the browser.\n * Experimentation shows that the point is around 50k when data starts to get\n * lost, so an 8K limit used here is safe.\n *\n * @param {ZeroClipboard} flash ZeroClipboard instance\n * @param {string}        data  Data to send to Flash\n */\nvar _setText = function ( flash, data )\n{\n\tvar parts = data.match(/[\\s\\S]{1,8192}/g) || [];\n\n\tflash.clearText();\n\tfor ( var i=0, len=parts.length ; i<len ; i++ )\n\t{\n\t\tflash.appendText( parts[i] );\n\t}\n};\n\n/**\n * Get the newline character(s)\n *\n * @param {object}  config Button configuration\n * @return {string}        Newline character\n */\nvar _newLine = function ( config )\n{\n\treturn config.newline ?\n\t\tconfig.newline :\n\t\tnavigator.userAgent.match(/Windows/) ?\n\t\t\t'\\r\\n' :\n\t\t\t'\\n';\n};\n\n/**\n * Combine the data from the `buttons.exportData` method into a string that\n * will be used in the export file.\n *\n * @param  {DataTable.Api} dt     DataTables API instance\n * @param  {object}        config Button configuration\n * @return {object}               The data to export\n */\nvar _exportData = function ( dt, config )\n{\n\tvar newLine = _newLine( config );\n\tvar data = dt.buttons.exportData( config.exportOptions );\n\tvar boundary = config.fieldBoundary;\n\tvar separator = config.fieldSeparator;\n\tvar reBoundary = new RegExp( boundary, 'g' );\n\tvar escapeChar = config.escapeChar !== undefined ?\n\t\tconfig.escapeChar :\n\t\t'\\\\';\n\tvar join = function ( a ) {\n\t\tvar s = '';\n\n\t\t// If there is a field boundary, then we might need to escape it in\n\t\t// the source data\n\t\tfor ( var i=0, ien=a.length ; i<ien ; i++ ) {\n\t\t\tif ( i > 0 ) {\n\t\t\t\ts += separator;\n\t\t\t}\n\n\t\t\ts += boundary ?\n\t\t\t\tboundary + ('' + a[i]).replace( reBoundary, escapeChar+boundary ) + boundary :\n\t\t\t\ta[i];\n\t\t}\n\n\t\treturn s;\n\t};\n\n\tvar header = config.header ? join( data.header )+newLine : '';\n\tvar footer = config.footer && data.footer ? newLine+join( data.footer ) : '';\n\tvar body = [];\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tbody.push( join( data.body[i] ) );\n\t}\n\n\treturn {\n\t\tstr: header + body.join( newLine ) + footer,\n\t\trows: body.length\n\t};\n};\n\n\n// Basic initialisation for the buttons is common between them\nvar flashButton = {\n\tavailable: function () {\n\t\treturn ZeroClipboard_TableTools.hasFlash();\n\t},\n\n\tinit: function ( dt, button, config ) {\n\t\t// Insert the Flash movie\n\t\tZeroClipboard_TableTools.moviePath = DataTable.Buttons.swfPath;\n\t\tvar flash = new ZeroClipboard_TableTools.Client();\n\n\t\tflash.setHandCursor( true );\n\t\tflash.addEventListener('mouseDown', function(client) {\n\t\t\tconfig._fromFlash = true;\n\t\t\tdt.button( button[0] ).trigger();\n\t\t\tconfig._fromFlash = false;\n\t\t} );\n\n\t\t_glue( flash, button );\n\n\t\tconfig._flash = flash;\n\t},\n\n\tdestroy: function ( dt, button, config ) {\n\t\tconfig._flash.destroy();\n\t},\n\n\tfieldSeparator: ',',\n\n\tfieldBoundary: '\"',\n\n\texportOptions: {},\n\n\ttitle: '*',\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*',\n\n\tfilename: '*',\n\n\textension: '.csv',\n\n\theader: true,\n\n\tfooter: false\n};\n\n\n/**\n * Convert from numeric position to letter for column names in Excel\n * @param  {int} n Column number\n * @return {string} Column letter(s) name\n */\nfunction createCellPos( n ){\n\tvar ordA = 'A'.charCodeAt(0);\n\tvar ordZ = 'Z'.charCodeAt(0);\n\tvar len = ordZ - ordA + 1;\n\tvar s = \"\";\n\n\twhile( n >= 0 ) {\n\t\ts = String.fromCharCode(n % len + ordA) + s;\n\t\tn = Math.floor(n / len) - 1;\n\t}\n\n\treturn s;\n}\n\n/**\n * Create an XML node and add any children, attributes, etc without needing to\n * be verbose in the DOM.\n *\n * @param  {object} doc      XML document\n * @param  {string} nodeName Node name\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\n *   (child nodes) and `text` (text content)\n * @return {node}            Created node\n */\nfunction _createNode( doc, nodeName, opts ){\n\tvar tempNode = doc.createElement( nodeName );\n\n\tif ( opts ) {\n\t\tif ( opts.attr ) {\n\t\t\t$(tempNode).attr( opts.attr );\n\t\t}\n\n\t\tif ( opts.children ) {\n\t\t\t$.each( opts.children, function ( key, value ) {\n\t\t\t\ttempNode.appendChild( value );\n\t\t\t} );\n\t\t}\n\n\t\tif ( opts.text !== null && opts.text !== undefined ) {\n\t\t\ttempNode.appendChild( doc.createTextNode( opts.text ) );\n\t\t}\n\t}\n\n\treturn tempNode;\n}\n\n/**\n * Get the width for an Excel column based on the contents of that column\n * @param  {object} data Data for export\n * @param  {int}    col  Column index\n * @return {int}         Column width\n */\nfunction _excelColWidth( data, col ) {\n\tvar max = data.header[col].length;\n\tvar len, lineSplit, str;\n\n\tif ( data.footer && data.footer[col].length > max ) {\n\t\tmax = data.footer[col].length;\n\t}\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tvar point = data.body[i][col];\n\t\tstr = point !== null && point !== undefined ?\n\t\t\tpoint.toString() :\n\t\t\t'';\n\n\t\t// If there is a newline character, workout the width of the column\n\t\t// based on the longest line in the string\n\t\tif ( str.indexOf('\\n') !== -1 ) {\n\t\t\tlineSplit = str.split('\\n');\n\t\t\tlineSplit.sort( function (a, b) {\n\t\t\t\treturn b.length - a.length;\n\t\t\t} );\n\n\t\t\tlen = lineSplit[0].length;\n\t\t}\n\t\telse {\n\t\t\tlen = str.length;\n\t\t}\n\n\t\tif ( len > max ) {\n\t\t\tmax = len;\n\t\t}\n\n\t\t// Max width rather than having potentially massive column widths\n\t\tif ( max > 40 ) {\n\t\t\treturn 52; // 40 * 1.3\n\t\t}\n\t}\n\n\tmax *= 1.3;\n\n\t// And a min width\n\treturn max > 6 ? max : 6;\n}\n\n  var _serialiser = \"\";\n    if (typeof window.XMLSerializer === 'undefined') {\n        _serialiser = new function () {\n            this.serializeToString = function (input) {\n                return input.xml\n            }\n        };\n    } else {\n        _serialiser =  new XMLSerializer();\n    }\n\n    var _ieExcel;\n\n\n/**\n * Convert XML documents in an object to strings\n * @param  {object} obj XLSX document object\n */\nfunction _xlsxToStrings( obj ) {\n\tif ( _ieExcel === undefined ) {\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n\t\t// drop attributes\n\t\t_ieExcel = _serialiser\n\t\t\t.serializeToString(\n\t\t\t\t$.parseXML( excelStrings['xl/worksheets/sheet1.xml'] )\n\t\t\t)\n\t\t\t.indexOf( 'xmlns:r' ) === -1;\n\t}\n\n\t$.each( obj, function ( name, val ) {\n\t\tif ( $.isPlainObject( val ) ) {\n\t\t\t_xlsxToStrings( val );\n\t\t}\n\t\telse {\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\n\t\t\t\t// from the root node, so we need to save them. Do this by\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\n\t\t\t\t// we convert back when serialised. Edge does not have this\n\t\t\t\t// issue\n\t\t\t\tvar worksheet = val.childNodes[0];\n\t\t\t\tvar i, ien;\n\t\t\t\tvar attrs = [];\n\n\t\t\t\tfor ( i=worksheet.attributes.length-1 ; i>=0 ; i-- ) {\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\n\n\t\t\t\t\tif ( attrName.indexOf( ':' ) !== -1 ) {\n\t\t\t\t\t\tattrs.push( { name: attrName, value: attrValue } );\n\n\t\t\t\t\t\tworksheet.removeAttribute( attrName );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor ( i=0, ien=attrs.length ; i<ien ; i++ ) {\n\t\t\t\t\tvar attr = val.createAttribute( attrs[i].name.replace( ':', '_dt_b_namespace_token_' ) );\n\t\t\t\t\tattr.value = attrs[i].value;\n\t\t\t\t\tworksheet.setAttributeNode( attr );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar str = _serialiser.serializeToString(val);\n\n\t\t\t// Fix IE's XML\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE doesn't include the XML declaration\n\t\t\t\tif ( str.indexOf( '<?xml' ) === -1 ) {\n\t\t\t\t\tstr = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+str;\n\t\t\t\t}\n\n\t\t\t\t// Return namespace attributes to being as such\n\t\t\t\tstr = str.replace( /_dt_b_namespace_token_/g, ':' );\n\t\t\t}\n\n\t\t\t// Safari, IE and Edge will put empty name space attributes onto\n\t\t\t// various elements making them useless. This strips them out\n\t\t\tstr = str.replace( /<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>' );\n\n\t\t\tobj[ name ] = str;\n\t\t}\n\t} );\n}\n\n// Excel - Pre-defined strings to build a basic XLSX file\nvar excelStrings = {\n\t\"_rels/.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"xl/_rels/workbook.xml.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'+\n\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"[Content_Types].xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'+\n\t\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />'+\n\t\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />'+\n\t\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />'+\n\t\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />'+\n\t\t'</Types>',\n\n\t\"xl/workbook.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'+\n\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>'+\n\t\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>'+\n\t\t\t'<bookViews>'+\n\t\t\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>'+\n\t\t\t'</bookViews>'+\n\t\t\t'<sheets>'+\n\t\t\t\t'<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>'+\n\t\t\t'</sheets>'+\n\t\t'</workbook>',\n\n\t\"xl/worksheets/sheet1.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<sheetData/>'+\n\t\t\t'<mergeCells count=\"0\"/>'+\n\t\t'</worksheet>',\n\n\t\"xl/styles.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<numFmts count=\"6\">'+\n\t\t\t\t'<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>'+\n\t\t\t'</numFmts>'+\n\t\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<color rgb=\"FFFFFFFF\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<b />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<i />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<u />'+\n\t\t\t\t'</font>'+\n\t\t\t'</fonts>'+\n\t\t\t'<fills count=\"6\">'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+ // Excel appears to use this as a dotted background regardless of values but\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+ // to be valid to the schema, use a patternFill\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD9D9D9\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD99795\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6efce\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6cfef\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t'</fills>'+\n\t\t\t'<borders count=\"2\">'+\n\t\t\t\t'<border>'+\n\t\t\t\t\t'<left />'+\n\t\t\t\t\t'<right />'+\n\t\t\t\t\t'<top />'+\n\t\t\t\t\t'<bottom />'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">'+\n\t\t\t\t\t'<left style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</left>'+\n\t\t\t\t\t'<right style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</right>'+\n\t\t\t\t\t'<top style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</top>'+\n\t\t\t\t\t'<bottom style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</bottom>'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t'</borders>'+\n\t\t\t'<cellStyleXfs count=\"1\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />'+\n\t\t\t'</cellStyleXfs>'+\n\t\t\t'<cellXfs count=\"61\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"left\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"center\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"right\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"fill\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment textRotation=\"90\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment wrapText=\"1\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t'</cellXfs>'+\n\t\t\t'<cellStyles count=\"1\">'+\n\t\t\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />'+\n\t\t\t'</cellStyles>'+\n\t\t\t'<dxfs count=\"0\" />'+\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />'+\n\t\t'</styleSheet>'\n};\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\n// virtually no difference in size, since the above can be easily compressed\n\n// Pattern matching for special number formats. Perhaps this should be exposed\n// via an API in future?\nvar _excelSpecials = [\n\t{ match: /^\\-?\\d+\\.\\d%$/,       style: 60, fmt: function (d) { return d/100; } }, // Precent with d.p.\n\t{ match: /^\\-?\\d+\\.?\\d*%$/,     style: 56, fmt: function (d) { return d/100; } }, // Percent\n\t{ match: /^\\-?\\$[\\d,]+.?\\d*$/,  style: 57 }, // Dollars\n\t{ match: /^\\-?£[\\d,]+.?\\d*$/,   style: 58 }, // Pounds\n\t{ match: /^\\-?€[\\d,]+.?\\d*$/,   style: 59 }, // Euros\n\t{ match: /^\\([\\d,]+\\)$/,        style: 61, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets\n\t{ match: /^\\([\\d,]+\\.\\d{2}\\)$/, style: 62, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets - 2d.p.\n\t{ match: /^[\\d,]+$/,            style: 63 }, // Numbers with thousand separators\n\t{ match: /^[\\d,]+\\.\\d{2}$/,     style: 64 }  // Numbers with 2d.p. and thousands separators\n];\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * DataTables options and methods\n */\n\n// Set the default SWF path\nDataTable.Buttons.swfPath = '//cdn.datatables.net/buttons/'+DataTable.Buttons.version+'/swf/flashExport.swf';\n\n// Method to allow Flash buttons to be resized when made visible - as they are\n// of zero height and width if initialised hidden\nDataTable.Api.register( 'buttons.resize()', function () {\n\t$.each( ZeroClipboard_TableTools.clients, function ( i, client ) {\n\t\tif ( client.domElement !== undefined && client.domElement.parentNode ) {\n\t\t\tclient.positionElement();\n\t\t}\n\t} );\n} );\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Button definitions\n */\n\n// Copy to clipboard\nDataTable.ext.buttons.copyFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-copy buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.copy', 'Copy' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Check that the trigger did actually occur due to a Flash activation\n\t\tif ( ! config._fromFlash ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.processing( true );\n\n\t\tvar flash = config._flash;\n\t\tvar exportData = _exportData( dt, config );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar newline = _newLine(config);\n\t\tvar output = exportData.str;\n\n\t\tif ( info.title ) {\n\t\t\toutput = info.title + newline + newline + output;\n\t\t}\n\n\t\tif ( info.messageTop ) {\n\t\t\toutput = info.messageTop + newline + newline + output;\n\t\t}\n\n\t\tif ( info.messageBottom ) {\n\t\t\toutput = output + newline + newline + info.messageBottom;\n\t\t}\n\n\t\tif ( config.customize ) {\n\t\t\toutput = config.customize( output, config, dt );\n\t\t}\n\n\t\tflash.setAction( 'copy' );\n\t\t_setText( flash, output );\n\n\t\tthis.processing( false );\n\n\t\tdt.buttons.info(\n\t\t\tdt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ),\n\t\t\tdt.i18n( 'buttons.copySuccess', {\n\t\t\t\t_: 'Copied %d rows to clipboard',\n\t\t\t\t1: 'Copied 1 row to clipboard'\n\t\t\t}, data.rows ),\n\t\t\t3000\n\t\t);\n\t},\n\n\tfieldSeparator: '\\t',\n\n\tfieldBoundary: ''\n} );\n\n// CSV save file\nDataTable.ext.buttons.csvFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-csv buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.csv', 'CSV' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Set the text\n\t\tvar flash = config._flash;\n\t\tvar data = _exportData( dt, config );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar output = config.customize ?\n\t\t\tconfig.customize( data.str, config, dt ) :\n\t\t\tdata.str;\n\n\t\tflash.setAction( 'csv' );\n\t\tflash.setFileName( info.filename );\n\t\t_setText( flash, output );\n\t},\n\n\tescapeChar: '\"'\n} );\n\n// Excel save file - this is really a CSV file using UTF-8 that Excel can read\nDataTable.ext.buttons.excelFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-excel buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.excel', 'Excel' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\tvar flash = config._flash;\n\t\tvar rowPos = 0;\n\t\tvar rels = $.parseXML( excelStrings['xl/worksheets/sheet1.xml'] ) ; //Parses xml\n\t\tvar relsGet = rels.getElementsByTagName( \"sheetData\" )[0];\n\n\t\tvar xlsx = {\n\t\t\t_rels: {\n\t\t\t\t\".rels\": $.parseXML( excelStrings['_rels/.rels'] )\n\t\t\t},\n\t\t\txl: {\n\t\t\t\t_rels: {\n\t\t\t\t\t\"workbook.xml.rels\": $.parseXML( excelStrings['xl/_rels/workbook.xml.rels'] )\n\t\t\t\t},\n\t\t\t\t\"workbook.xml\": $.parseXML( excelStrings['xl/workbook.xml'] ),\n\t\t\t\t\"styles.xml\": $.parseXML( excelStrings['xl/styles.xml'] ),\n\t\t\t\t\"worksheets\": {\n\t\t\t\t\t\"sheet1.xml\": rels\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t\"[Content_Types].xml\": $.parseXML( excelStrings['[Content_Types].xml'])\n\t\t};\n\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar currentRow, rowNode;\n\t\tvar addRow = function ( row ) {\n\t\t\tcurrentRow = rowPos+1;\n\t\t\trowNode = _createNode( rels, \"row\", { attr: {r:currentRow} } );\n\n\t\t\tfor ( var i=0, ien=row.length ; i<ien ; i++ ) {\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\n\t\t\t\tvar cell = null;\n\n\t\t\t\t// For null, undefined of blank cell, continue so it doesn't create the _createNode\n\t\t\t\tif ( row[i] === null || row[i] === undefined || row[i] === '' ) {\n\t\t\t\t\tif ( config.createEmptyCells === true ) {\n\t\t\t\t\t\trow[i] = '';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trow[i] = typeof row[i].trim === 'function'\n\t\t\t\t\t? row[i].trim()\n\t\t\t\t\t: row[i];\n\n\t\t\t\t// Special number formatting options\n\t\t\t\tfor ( var j=0, jen=_excelSpecials.length ; j<jen ; j++ ) {\n\t\t\t\t\tvar special = _excelSpecials[j];\n\n\t\t\t\t\t// TODO Need to provide the ability for the specials to say\n\t\t\t\t\t// if they are returning a string, since at the moment it is\n\t\t\t\t\t// assumed to be a number\n\t\t\t\t\tif ( row[i].match && ! row[i].match(/^0\\d+/) && row[i].match( special.match ) ) {\n\t\t\t\t\t\tvar val = row[i].replace(/[^\\d\\.\\-]/g, '');\n\n\t\t\t\t\t\tif ( special.fmt ) {\n\t\t\t\t\t\t\tval = special.fmt( val );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tr: cellId,\n\t\t\t\t\t\t\t\ts: special.style\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: val } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( ! cell ) {\n\t\t\t\t\tif ( typeof row[i] === 'number' || (\n\t\t\t\t\t\trow[i].match &&\n\t\t\t\t\t\trow[i].match(/^-?\\d+(\\.\\d+)?$/) &&\n\t\t\t\t\t\t! row[i].match(/^0\\d+/) )\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Detect numbers - don't match numbers with leading zeros\n\t\t\t\t\t\t// or a negative anywhere but the start\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'n',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: row[i] } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// String output - replace non standard characters for text output\n\t\t\t\t\t\tvar text = ! row[i].replace ?\n\t\t\t\t\t\t\trow[i] :\n\t\t\t\t\t\t\trow[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'inlineStr',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren:{\n\t\t\t\t\t\t\t\trow: _createNode( rels, 'is', {\n\t\t\t\t\t\t\t\t\tchildren: {\n\t\t\t\t\t\t\t\t\t\trow: _createNode( rels, 't', {\n\t\t\t\t\t\t\t\t\t\t\ttext: text\n\t\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trowNode.appendChild( cell );\n\t\t\t}\n\n\t\t\trelsGet.appendChild(rowNode);\n\t\t\trowPos++;\n\t\t};\n\n\t\t$( 'sheets sheet', xlsx.xl['workbook.xml'] ).attr( 'name', _sheetname( config ) );\n\n\t\tif ( config.customizeData ) {\n\t\t\tconfig.customizeData( data );\n\t\t}\n\n\t\tvar mergeCells = function ( row, colspan ) {\n\t\t\tvar mergeCells = $('mergeCells', rels);\n\n\t\t\tmergeCells[0].appendChild( _createNode( rels, 'mergeCell', {\n\t\t\t\tattr: {\n\t\t\t\t\tref: 'A'+row+':'+createCellPos(colspan)+row\n\t\t\t\t}\n\t\t\t} ) );\n\t\t\tmergeCells.attr( 'count', mergeCells.attr( 'count' )+1 );\n\t\t\t$('row:eq('+(row-1)+') c', rels).attr( 's', '51' ); // centre\n\t\t};\n\n\t\t// Title and top messages\n\t\tvar exportInfo = dt.buttons.exportInfo( config );\n\t\tif ( exportInfo.title ) {\n\t\t\taddRow( [exportInfo.title], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\tif ( exportInfo.messageTop ) {\n\t\t\taddRow( [exportInfo.messageTop], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\t// Table itself\n\t\tif ( config.header ) {\n\t\t\taddRow( data.header, rowPos );\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\tfor ( var n=0, ie=data.body.length ; n<ie ; n++ ) {\n\t\t\taddRow( data.body[n], rowPos );\n\t\t}\n\n\t\tif ( config.footer && data.footer ) {\n\t\t\taddRow( data.footer, rowPos);\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\t// Below the table\n\t\tif ( exportInfo.messageBottom ) {\n\t\t\taddRow( [exportInfo.messageBottom], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\t// Set column widths\n\t\tvar cols = _createNode( rels, 'cols' );\n\t\t$('worksheet', rels).prepend( cols );\n\n\t\tfor ( var i=0, ien=data.header.length ; i<ien ; i++ ) {\n\t\t\tcols.appendChild( _createNode( rels, 'col', {\n\t\t\t\tattr: {\n\t\t\t\t\tmin: i+1,\n\t\t\t\t\tmax: i+1,\n\t\t\t\t\twidth: _excelColWidth( data, i ),\n\t\t\t\t\tcustomWidth: 1\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\t// Let the developer customise the document if they want to\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( xlsx, config, dt );\n\t\t}\n\n\t\t_xlsxToStrings( xlsx );\n\n\t\tflash.setAction( 'excel' );\n\t\tflash.setFileName( exportInfo.filename );\n\t\tflash.setSheetData( xlsx );\n\t\t_setText( flash, '' );\n\n\t\tthis.processing( false );\n\t},\n\n\textension: '.xlsx',\n\t\n\tcreateEmptyCells: false\n} );\n\n\n\n// PDF export\nDataTable.ext.buttons.pdfFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-pdf buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.pdf', 'PDF' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\t// Set the text\n\t\tvar flash = config._flash;\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar totalWidth = dt.table().node().offsetWidth;\n\n\t\t// Calculate the column width ratios for layout of the table in the PDF\n\t\tvar ratios = dt.columns( config.columns ).indexes().map( function ( idx ) {\n\t\t\treturn dt.column( idx ).header().offsetWidth / totalWidth;\n\t\t} );\n\n\t\tflash.setAction( 'pdf' );\n\t\tflash.setFileName( info.filename );\n\n\t\t_setText( flash, JSON.stringify( {\n\t\t\ttitle:         info.title || '',\n\t\t\tmessageTop:    info.messageTop || '',\n\t\t\tmessageBottom: info.messageBottom || '',\n\t\t\tcolWidth:      ratios.toArray(),\n\t\t\torientation:   config.orientation,\n\t\t\tsize:          config.pageSize,\n\t\t\theader:        config.header ? data.header : null,\n\t\t\tfooter:        config.footer ? data.footer : null,\n\t\t\tbody:          data.body\n\t\t} ) );\n\n\t\tthis.processing( false );\n\t},\n\n\textension: '.pdf',\n\n\torientation: 'portrait',\n\n\tpageSize: 'A4',\n\n\tnewline: '\\n'\n} );\n\n\nreturn DataTable.Buttons;\n}));\n"]},"metadata":{},"sourceType":"script"}